// Reut levy 206238123 Hadar Kornyanski 208714030

CREATE TABLE "Apartment" ( "Type" TEXT NOT NULL, "NID" INTEGER NOT NULL, "SizeSquareMeter" INTEGER NOT NULL, "StreetName" TEXT NOT NULL, "Number" INTEGER NOT NULL, "Door" INTEGER NOT NULL, PRIMARY KEY("StreetName","Number","Door"), FOREIGN KEY("NID") REFERENCES "Neighborhood"("NID") ON UPDATE RESTRICT );
CREATE TABLE "CarParking" ( "StartTime" DATE NOT NULL, "EndTime" DATE NOT NULL CHECK(EndTime>=StartTime), "AID" INTEGER, "CID" INTEGER NOT NULL, "Cost" INTEGER NOT NULL, FOREIGN KEY("AID") REFERENCES "ParkingArea"("AID") ON DELETE SET NULL, PRIMARY KEY("CID","StartTime"), FOREIGN KEY("CID") REFERENCES "Car"("CID")ON DELETE CASCADE );
CREATE TABLE "Car" ( "CID" INTEGER NOT NULL UNIQUE, "CellPhoneNumber" INTEGER NOT NULL, "CreditCard" INTEGER NOT NULL, "ExpirationDate" INTEGER NOT NULL, "ThreeDigits" INTEGER NOT NULL CHECK(ThreeDigits>99 AND ThreeDigits<1000), "ID" INTEGER NOT NULL, PRIMARY KEY("CID")  );
CREATE TABLE "CellPhoneNumber" ( "CellphoneNumber" INTEGER NOT NULL UNIQUE, "EID" INTEGER NOT NULL, PRIMARY KEY("CellphoneNumber"), FOREIGN KEY("EID") REFERENCES "Employee" );
CREATE TABLE "ConstructorEmployee" ( "CompanyName" TEXT NOT NULL, "SalaryPerDay" INTEGER NOT NULL, "EID" INTEGER NOT NULL UNIQUE, PRIMARY KEY("EID"), FOREIGN KEY("EID") REFERENCES "Employee"("EID") );
CREATE TABLE "Department" ( "DID" INTEGER NOT NULL UNIQUE, "Name" TEXT NOT NULL UNIQUE, "Description" TEXT NOT NULL, "ManagerID" INTEGER , PRIMARY KEY("DID") , FOREIGN KEY("ManagerID") REFERENCES "OfficialEmployee"("EID") ON DELETE RESTRICT );
CREATE TABLE "Employee" ( "EID" INTEGER NOT NULL ,"FirstName" TEXT NOT NULL, "LastName" TEXT NOT NULL, "BirthDate" DATE NOT NULL, "City" TEXT NOT NULL, "StreetName" TEXT NOT NULL, "Number" INTEGER NOT NULL, "Door" INTEGER NOT NULL, PRIMARY KEY("EID") );
CREATE TABLE "Neighborhood" ( "NID" INTEGER NOT NULL UNIQUE, "Name" TEXT NOT NULL, PRIMARY KEY("NID") );
CREATE TABLE "OfficialEmployee" ( "StartWorkingDate" INTEGER NOT NULL, "Degree" INTEGER NOT NULL, "EID" INTEGER NOT NULL UNIQUE, "Department" INTEGER NOT NULL, PRIMARY KEY("EID"), FOREIGN KEY("EID") REFERENCES "Employee"("EID"), FOREIGN KEY("Department") REFERENCES "Department"("DID")ON DELETE CASCADE );
CREATE TABLE "ParkingArea" ( "AID" INTEGER NOT NULL UNIQUE, "Name" TEXT NOT NULL, "NID" INTEGER , "PricePerHour" INTEGER NOT NULL, "MaxPricePerDay" INTEGER NOT NULL  CHECK(MaxPricePerDay>PricePerHour), PRIMARY KEY("AID"), FOREIGN KEY("NID") REFERENCES "Neighborhood"("NID") ON DELETE CASCADE);
CREATE TABLE "Project" ( "PID" INTEGER NOT NULL UNIQUE, "Name" TEXT NOT NULL, "Description" TEXT NOT NULL, "Budget" INTEGER NOT NULL, "Neighborhood" INTEGER NOT NULL, PRIMARY KEY("PID"), FOREIGN KEY("Neighborhood") REFERENCES "Neighborhood"("NID") ON UPDATE RESTRICT );
CREATE TABLE "ProjectConstructorEmployee" ( "StartWorkingDate" INTEGER NOT NULL, "EndWorkingDate" INTEGER NOT NULL CHECK(EndWorkingDate>StartWorkingDate), "JobDescription" INTEGER NOT NULL, "EID" INTEGER NOT NULL, "PID" INTEGER NOT NULL, PRIMARY KEY("EID","PID"), FOREIGN KEY("PID") REFERENCES "Project"("PID"), FOREIGN KEY("EID") REFERENCES "ConstructorEmployee"("EID") ON DELETE RESTRICT );
CREATE TABLE "Resident" ( "RID" INTEGER NOT NULL UNIQUE, "FirstName" TEXT NOT NULL, "LastName" TEXT NOT NULL, "BirthDate" DATE NOT NULL, "StreetName" TEXT NOT NULL, "Door" INTEGER NOT NULL, "Number" INTEGER NOT NULL, PRIMARY KEY("RID"), FOREIGN KEY("StreetName","Number","Door")  REFERENCES "Apartment"("StreetName","Number","Door") ON DELETE RESTRICT );
CREATE TABLE "TrashCan" ( "CatalogID" INTEGER NOT NULL UNIQUE, "ExpirationDate" DATE NOT NULL CHECK(ExpirationDate>CreationDate), "CreationDate" DATE NOT NULL, "TCID" INTEGER NOT NULL, "RID" INTEGER, PRIMARY KEY("CatalogID","TCID"), FOREIGN KEY("RID") REFERENCES "Resident"("RID") );
